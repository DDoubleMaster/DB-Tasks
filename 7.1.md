# TASK 7.1. РАЗРАБОТКА ПОДЗАПРОСОВ
## 1.Scalar
```SQL
-- найти лампы с минимальной ценой
select lamp_name, price
from dse_lamp
where price = (select min(price) from dse_lamp);
```
![1.Scalar.png](/resources/7.1/1.Scalar.png)
## 2.Tabular
```SQL
-- средняя цена по категориям через подзапрос в from
select c.category_name, avg_tbl.avg_price
from dse_category c
join (
    select category_id, avg(price) as avg_price
    from dse_lamp
    group by category_id
) avg_tbl on c.category_id = avg_tbl.category_id;
```
![2.Tabular.png](/resources/7.1/2.Tabular.png)
## 3.List
```SQL
-- лампы брендов из определённых стран
select lamp_name, price
from dse_lamp
where brand_id in (
    select brand_id from dse_brand where country in ('Germany','USA')
);
```
![3.List.png](/resources/7.1/3.List.png)
## 4.Logical
```SQL
-- бренды, у которых есть хотя бы одна лампа
select b.brand_name
from dse_brand b
where exists (
    select 1 from dse_lamp l where l.brand_id = b.brand_id
);
```
![4.Logical.png](/resources/7.1/4.Logical.png)
## 5.Correlated
```SQL
-- лампы дороже среднего по своей категории
select lamp_name, price
from dse_lamp l
where price > (
    select avg(l2.price)
    from dse_lamp l2
    where l2.category_id = l.category_id
);
```
![5.Correlated.png](/resources/7.1/5.Correlated.png)
## 6.С ALL
```SQL
-- лампы дешевле всех ламп бренда 'LightPro'
select lamp_name, price
from dse_lamp
where price < all (
    select price from dse_lamp where brand_id = 1
);
```
![6.С_ _ALL.png](/resources/7.1/6.С_ALL.png)
## 7.С ANY SOME
```SQL
-- лампы дороже хотя бы одной лампы бренда 'EcoLamp'
select lamp_name, price
from dse_lamp
where price > any (
    select price from dse_lamp where brand_id = 3
);
```
![7.С_ANY_SOME.png](/resources/7.1/7.С_ANY_SOME.png)
## 8.В DML
```SQL
-- увеличить цену на 10% для ламп дешевле среднего
update dse_lamp
set price = price * 1.1
where price < (select avg(price) from dse_lamp);
```
![8.В_DML.png](/resources/7.1/8.В_DML.png)
## 9.С LIMIT и OFFSET
```SQL
-- третья по дороговизне лампа
select lamp_name, price
from dse_lamp
where price = (
    select price
    from dse_lamp
    order by price desc
    limit 1 offset 2
);
```
![9.С_LIMIT_и_OFFSET.png](/resources/7.1/9.С_LIMIT_и_OFFSET.png)